### 38. Базовый протокол распределения ключей для асимметричных криптосистем с использованием сертификатов открытых ключей.

В этом протоколе используется идея сертификатов открытых ключей.

Сертификатом открытого ключа С называется сообщение ЦРК, удостоверяющее целостность некоторого открытого ключа объекта. Например, сертификат открытого ключа для пользователя A, обозначаемый СА, содержит отметку времени Т, идентификатор ldA и открытый ключ КА, зашифрованные секретным ключом ЦРК КЦРК, т. е. СА = Екцрк(Т, ldA, КА).

Отметка времени Т используется для подтверждения актуальности сертификата и тем самым предотвращает повторы прежних сертификатов, которые содержат открытые ключи и для которых соответствующие секретные ключи несостоятельны.

Секретный ключ кЦРК известен только менеджеру ЦРК. Открытый ключ Кцрк известен участникам А и В. ЦРК поддерживает таблицу открытых ключей всех объектов сети, которые он обслуживает.

Вызывающий объект А инициирует стадию установления ключа, запрашивая у ЦРК сертификат своего открытого ключа и открытого ключа участника В:

1. **А -> ЦРК: ldA,ldB ,"Вышлите сертификаты ключей А и В".**

Здесь ldA и ldB- уникальные идентификаторы соответственно участников А и В.

Менеджер ЦРК отвечает сообщением

2. **ЦРК-> А: Екцрк(Т, ldA. Ка), Екцрк(Т, ldВ, KB).**

Участник А, используя открытый ключ ЦРК кЦРК, расшифровывает ответ ЦРК, проверяет оба сертификата. Идентификатор ldB убеждает А, что личность вызываемого участника правильно зафиксирована в ЦРК и Кв - действительно открытый ключ участника B, поскольку оба зашифрованы ключом кЦРК.

Хотя открытые ключи предполагаются известными всем, посредничество ЦРК позволяет подтвердить их целостность. Без такого посредничества злоумышленник может снабдить А своим открытым ключом, который А будет считать ключом участника В. Затем злоумышленник может подменить собой В и установить связь с А, и его никто не сможет выявить. Следующий шаг протокола включает установление связи А с В:

3. **А->В: СА1 Ека(Т),Екв(г1).**

Здесь СА-сертификат открытого ключа пользователя А; Ека(Т)-отметка времени, зашифрованная секретным ключом участника А и являющаяся подписью участника А, поскольку никто другой не может создать такую подпись; г - случайное число, генерируемое А и используемое для обмена с В в ходе процедуры подлинности.

Если сертификат СА и подпись А верны, то участник В уверен, что сообщение пришло от А. Часть сообщения Екв(г,) может расшифровать только В, поскольку никто другой не знает секретного ключа кв, соответствующего открытому ключу Кв. Участник В расшифровывает значение числа г, и, чтобы подтвердить свою подлинность, посылает участнику А сообщение

4. **В->Екa(r,).**

Участник А восстанавливает значение г, расшифровывая это сообщение с использованием своего секретного ключа кА. Если это ожидаемое значение г, то А получает подтверждение, что вызываемый участник действительно В. Протокол, основанный на симметричном шифровании, функционирует быстрее, чем протокол, основанный на криптосистемах с открытыми ключами. Однако способность систем с открытыми ключами генерировать цифровые подписи, обеспечивающие различные функции защиты, компенсирует избыточность требуемых вычислений.

___
