### 38. Базовый протокол распределения ключей для асимметричных криптосистем с использованием сертификатов открытых ключей.

В этом протоколе используется идея сертификатов открытых ключей.

#### Сертификат открытого ключа *С*
* Сообщение ЦРК, удостоверяющее целостность некоторого открытого ключа объекта. 
* сертификат открытого ключа для пользователя A, обозначаемый С~А~, содержит:
  *  отметку времени Т, 
  *  идентификатор Id~A~
  *  открытый ключ К~А~,
     * **зашифрованные секретным ключом ЦРК** К~ЦРК~ т.
* С~A~ = Е~Кцрк~(Т, Id~A~, К~А~).

Отметка времени Т используется для подтверждения актуальности сертификата и тем самым предотвращает повторы прежних сертификатов, которые содержат открытые ключи и для которых соответствующие секретные ключи несостоятельны.

- *Секретный ключ К^с^~ЦРК~ известен только менеджеру ЦРК*. 
- Открытый ключ К^о^~црк~ известен участникам А и В.


ЦРК поддерживает таблицу открытых ключей всех объектов сети, которые он обслуживает.

#### Протокол распределения ключей
Вызывающий объект А инициирует стадию установления ключа, запрашивая у ЦРК сертификат своего открытого ключа и открытого ключа участника В:

1. **А -> ЦРК: Id~A~,Id~B~ ,"Вышлите сертификаты ключей А и В".**

Менеджер ЦРК отвечает сообщением

2. **ЦРК-> А:** 
   *  С~A~= (T~A~, Id~A~, K^o^~A~) + ЭЦП црк для этих данных  
   *  С~B~= (T~B~, Id~B~, K^o^~B~) + ЭЦП црк для этих данных

      * А проверяет подлинность сертификата B и берет себе K^o^~B~.
      * Проверяет сроки действия T~A~, T~B~.   
3. **А->В**: 
   * С~A~,
   * Е~Ka_секрет~(Т),
   * Е~KB_открыт~(r~1~).

Здесь 
С~А~-сертификат открытого ключа пользователя А; 
Е~Ka_секрет~(Т)- отметка времени, подписанная участником А; 
r - случайное число, генерируемое А и используемое для обмена с В в ходе процедуры подлинности.

4. **В->Е~Ka~(f(r~1~)).**
