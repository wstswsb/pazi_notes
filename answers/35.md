### 35. Схема взаимной аутентификации с использованием рукопожатия. Аутентификация сторон взаимодействия с использованием механизма «запрос-ответ»

Похоже, что повтор вопроса 34.

***По сути это механизм запрос-ответ, усиленный шифрованием***

Стороны признают друг друга законными партнерами, если докажут друг другу, что обладают правильными ключами. 
Процедуру рукопожатия обычно применяют в компьютерных сетях при организации сеанса связи между:
1. пользователями,
2. пользователем и хост-компьютером,
3. между хост-компьютерами и т.д. 

Рассмотрим в качестве примера процедуру рукопожатия для двух пользователей А и В. (*Это допущение не влияет на общность рассмотрения*). Пусть применяется симметричная криптосистема. Пользователи А и В разделяют один и тот же секретный кпюч К~AB~.

1. Пусть пользователь А инициирует процедуру рукопожатия, отправляя пользователю В свой идентификатор ID~A~ в открытой форме.
2. Пользователь В, получив идентификатор ID~А~, находит в базе данных секретный ключ К~AB~ и вводит его в свою криптосистему.
3. Тем временем пользователь А генерирует случайную последовательность S с помощью псевдослучайного генератора РG и отправляет ее пользователю В в виде **криптограммы**.
4. Пользователь В расшифровывает эту криптограмму и раскрывает исходный вид последовательности S.
5. Затем оба пользователя А и В преобразуют последовательность S, используя открытую одностороннюю функцию a(·).
6. Пользователь В шифрует сообщение a(S) и отправляет эту криптограмму пользователю А.
7. Наконец, пользователь А расшифровывает эту криптограмму и сравнивает полученное сообщение a'(S) с исходным a(S). Если эти сообщения равны, пользователь А признает подлинность пользователя В.


Очевидно, пользователь В проверяет подлинность пользователя А таким же способом. Обе эти процедуры образуют процедуру рукопожатия, которая обычно выполняется в самом начале любого сеанса связи между любыми двумя сторонами в компьютерных сетях.

Достоинством модели рукопожатия является то, что ни один из участников сеанса связи не получает никакой секретной информации во время процедуры подтверждения подлинности.
Вся процедура показана на рис 1
![Рисунок 1 - Схема процедуры рукопожатия (пользователь А проверяет подлинность пользователя В)](/images/схема%20аутентификации%20с%20рукопожатием.png)

___
