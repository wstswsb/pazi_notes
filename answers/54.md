### 54. Методы и средства контроля целостности сообщений. Использование шифрования, ЭЦП, кодов аутентификации сообщений,  имитовставок.

**Проверка целостности** сообщения гарантирует **невозможность его модификации** из-за подмены злоумышленником или случайного искажения.

Защитить передаваемую информацию можно путём добавления к ней некоторого контрольного поля - **контрольной суммы.**
 В зависимости от того, на основе какой информации и по каким правилам вырабатывается эта сумма, различают алгоритмы вычисления:
* хеш-функций
* имитовставки 
* электронной цифровой подписи (ЭЦП).

#### ХЭШ
Хэш-функция – это преобразование, отображающее множество битовых строк произвольной длины на множество битовых строк фиксированной длины.
**Криптографически стойкой** называют хеш-функцию, удовлетворяющую следующим свойствам:
- вычислительно сложно найти текст, который при хешировании выдаст заданный хеш;
- вычислительно сложно найти коллизию – т.е. пару исходных текстов, которые дадут одинаковое значение хеша. 

Под словосочетанием «вычислительно сложно» подразумевается, что для выполнения вычислений за разумное время необходима вычислительная мощность и/или объём оперативной памяти, превосходящий реально доступный на данном уровне развития вычислительной техники.

Недостатком использования хеш-функции для защиты информации является тот факт, что значение хеша зависит только от передаваемого сообщения. То есть, злоумышленник может изменить сообщение, и затем заново вычислить значение хеша, введя принимающую сторону в заблуждение

#### ИМИТОВСТАВКА
Для защиты от атак подмены сообщения и вычисления нового значения хеша применяются алгоритмы выработки имитовставки. 
В англоязычной литературе такие алгоритмы называют MAC – Message Authenfication Code – код аутентификации сообщения. 
Такие алгоритмы похожи на алгоритмы хеширования, с той разницей, что имитовставка зависит не только от исходного текста, но и от ключа.
Злоумышленник, не знающий ключа, не сможет рассчитать имитовставку для изменённого сообщения.
Таким образом, имитовставка может обеспечить все необходимые свойства сообщений – аутентификацию отправителя, целостность, невозможность отрицания авторства.

К недостаткам имитовставки можно отнести использование одного и того же ключа для выработки и для проверки имитовставки, что порождает проблемы распределения ключей, присущие всем методам симметричной криптографии.

#### ЭЦП
В алгоритмах ЭЦП используется не один ключ, а ключевая пара.
Один из ключей в этой паре называется открытым, второй – закрытым (секретным, личным). 
Открытый ключ известен всем участникам, желающим получать сообщения от данного отправителя и проверять его подписи. 
Закрытый ключ известен только отправителю сообщения.
Формирование ЭЦП осуществляется отправителем на основе сообщения и закрытого ключа.
Проверка ЭЦП осуществляется получателем с помощью сообщения, открытого ключа отправителя и цифровой подписи. 
Таким образом, обеспечивается аутентификация, целостность и неотрицание авторства – сформировать верную подпись для сообщения может только отправитель, знающий закрытый ключ.

Такие системы позволяют обеспечить безопасную коммуникацию даже тогда, когда нет возможности распределить ключи по безопасному каналу. Однако схемы ЭЦП не свободны от недостатков. 
Как правило, вычисление подписи требует больших затрат времени, чем формирование имитовставки.
Генерация ключевой пары занимает ещё больше времени. 
Кроме того, необходимо контролировать передаваемые открытые ключи, чтобы злоумышленник не мог, перехватив их, организовать атаку «человек посередине».
