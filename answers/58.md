### 58. Алгоритм обработки списков прав доступа (произвольное управление доступом) в системах WindowsNT.

Поддерживается произвольное управление доступом (discretionary access control, DAC) с помощью ACL. Каждый объект имеет свой ACL, который состоит из так называемых сущностей контроля доступа (Access Control Entries – ACE). Существует 3 типа ACE: ACE Allowed (разрешает указанный тип доступа), ACE Denied (запрещает), третий используется для аудита. Первые 2 ACE содержат маску доступа, определяющую разреш. или запрещ. типы доступа.

Каждый список ACL содержит в себе набор записей контроля доступа (Access Control Entry, ACE). Каждая запись включает в себя следующие поля:
- Идентификатор безопасности (SID) пользователя или группы, к которым применяется данная запись;
- Маска доступа, определяющая набор разрешений на данный объект;
- Набор флагов, определяющих, могут ли дочерние объекты наследовать данную ACE;
- Тип ACE (разрешение, запрет или аудит).
Если в дескрипторе безопасности отсутствует ACL, то объект считается незащищенным и получить к нему доступ могут все желающие. Если же ACL есть, но в нем отсутствуют ACE, то доступ к объекту закрыт для всех.

**Алгоритм контроля доступа в системах Windows**
1. Система сравнивает идентификатор процесса, запросившего доступ с идентификаторами, присутствующими в ACL объекта. Если в ACL отсутствует упоминание этого идентф. то доступ запрещается. Если идентиф. присутствует в ACL, то сначала обрабатывается ACЕ типа Denied, а затем типа Allowed.
2. Для всех ACЕ, имеющих тип Denied, запрашиваемый тип доступа сравнивается с указанным в маске ACЕ. Если хотя бы один тип доступа (чтение, запись и т.д.) присутствует в обеих масках, то доступ запрещается. После обработки всех ACЕ этого типа начинается обработка элементов типа Allowed.
3. Для всех ACЕ типа Allowed запрашиваемый тип доступа сравнивается с указанным в маске ACЕ. Если все типы доступа в запросе встретились в масках ACЕ, доступ разрешается, если не все – запрещается.