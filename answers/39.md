### 39. Инфраструктура открытых ключей в соответствие с рекомендациями X.509.

**Инфраструктура открытых ключей ( PKI - Public Key Infrastructure)** - технология аутентификации с помощью открытых ключей. Это комплексная система, которая связывает открытые ключи с личностью пользователя посредством удостоверяющего центра (УЦ).

Фактически, PKI представляет собой систему, основным компонентом которой является удостоверяющий центр и пользователи, взаимодействующие между собой посредством удостоверяющего центра.

В основе PKI лежит использование криптографической системы с открытом ключом и несколько основных принципов:
- закрытый ключ известен только его владельцу;
- удостоверяющий центр создает сертификат открытого ключа, удостоверяя этот ключ;
- никто не доверяет друг другу, но все доверяют удостоверяющему центру;
- удостоверяющий центр подтверждает или опровергает принадлежность открытого ключа заданному лицу, которое владеет соответствующим закрытым ключом.  

PKI реализуется в модели клиент-сервер.
Основные компоненты PKI:
- **Удостоверяющий центр (УЦ)** является основной структурой, формирующей цифровые сертификаты подчиненных центров сертификации и конечных пользователей.
- **Сертификат открытого ключа (чаще всего просто сертификат)** - это данные пользователя и его открытый ключ, скрепленные подписью УЦ.
- **Certificate Authority (CA) – удостоверяющий (сертификационный) центр** – это уполномоченный орган, который создает и подписывает сертификаты открытого ключа. Дополнительно СА может создавать пары закрытый/открытый ключ
конечного участника. Важно заметить, что СА отвечает за сертификаты открытого ключа в течение всего времени их жизни, а не только в момент выпуска.
- **Регистрационный центр (РЦ)** - необязательный компонент системы, предназначенный для регистрации пользователей. Удостоверяющий центр доверяет регистрационному центру проверку информации о субъекте. Регистрационный центр проверив правильность информации, подписывает её своим ключом и передаёт удостоверяющему центру, который, проверив ключ регистрационного центра, выписывает сертификат. 
- Один регистрационный центр может работать с несколькими удостоверяющими центрами (т.е. состоять в нескольких PKI), один удостоверяющий центр может работать с несколькими регистрационными центрами.
Иногда, удостоверяющий центр выполняет функции регистрационного центра.
- **Конечные пользователи** - пользователи или приложения, являющиеся владельцами сертификата и использующие инфраструктуру управления открытыми ключами.


**Х.500** – стандарт службы каталогов.
Рекомендации **Х.509** Международного союза телекоммуникаций (ITU – International Telecommunication Union) – часть рекомендаций серии Х.500. Появился в 1988 году. После исправлений – в 1993 году.
**Обозначения:**
- Y«Х» - удостоверение пользователя Х, выданное центром сертификации Y
- Y{I} – подпись I объектом Y. Она состоит из I с добавленным шифрованным хэш-кодом.

**Основные поля сертификата Х.509:**
- V – версия:
- SN – порядковый номер;
- AI – идентификатор алгоритма подписи (не слишком полезное, т.к. в конце есть поле в подписи);
- СА – имя объекта, выдавшего сертификат;
- Т~А~ – срок действия;
- А – имя субъекта;
- А~Р~ – информация об открытом ключе субъекта.

CA«A» = CA {V,SN,AI,CA,T~A~,A,A~P~}, где
Y«Х» - удостоверение Х, выдан. Y; Y{I} – подпись I объектом Y

**Структура сертификата X.509**
![Рисунок 1](/images/Screenshot_4.png)

**Стандарт X.509 версия 3**
![Рисунок 2](/images/Screenshot_5.png)

**Отзыв сертификатов**
В некоторых ситуациях желательно иметь возможность отменить действие сертификата до окончания срока его действия по следующим причинам:
- Секретный ключ пользователя оказался скомпрометированным.
- Пользователь больше не сертифицируется в данном центре сертификации.
- Сертификат данного центра сертификации оказался скомпрометированным.

Каждый центр должен поддерживать **список отозванных сертификатов (CRL – Certificate Revocation List)**. **CRL** должны размещаться в каталоге, подписываются центром сертификации и включают имя центра, дату создания списка, дату выхода следующей версии CRL и **запись** для каждого отозванного сертификата. **Запись** состоит из
порядкового номера сертификата и даты отзыва этого сертфиката.

**Важность стандарта Х.509**
Структура сертификатов и протоколов аутентификации, определяемых в Х.509, используется в протоколах
S/MIME (Secure/Multipurpose Internet Mail Extension) – защищенное многоцелевое расширение электронной почты, IP Security, SSL/TLS, SET.