### 28.  Одноразовые пароли. Система S/Key генерации одноразовых паролей.

 *One-time Password (OTP)*

#### Система S/Key для генерации одноразовых паролей
* Определена в RFC 1760.
* представляет собой систему генерирования одноразовых паролей на основе стандартов `MD4` и `MD5`.
* предназначена для борьбы с "повторными атаками"

#### Архитектура
Генерация одноразовых паролей:
![](/answers/images/генерация%20одноразовых%20паролей%20sKey.png)

    K - вектор инициализации
    N - целое число
    h - хэш-функция
    0 <= i <= N-1

![](/answers/images/sKey%20процесс%20аутентификации.png)

1. Пользователь посылает серверу свой логин
2. Сервер в ответ посылает число N-1
3. Пользователь вычисляет одноразовый пароль *p~i+1~ = h(K)^N-1^*
4. Сервер вычисляет p'~i~ = h(p~i+1~). Если p'~i~ = p~i~ пользователь - подлинный. 

Предполагается, что пользователю известна секретная величина k.
На предварительном этапе k объединяется со случайной величиной S, присланной сервером.
В результате получается некоторая величина K=( k||S )
Далее пользователь выбирает некоторое целое число N, лежащее в диапазоне от 500 до 1000.
Генерирует первый одноразовый пароль путем применения хэш-функции к значению ( k||s ) N раз. 
Следующий одноразовый пароль будет генерироваться путем применения хэш-функции к значению ( k||s ) только (N - 1) раз и т.д.
Таким образом формируется последовательность одноразовых паролей, используемых для аутентификации
Пользователь посылает на сервер первое значение одноразового пароля P~0~, вычисленное по формуле и число N.
Данный пароль для аутентификации не используется, а выступает для сервера в роли начального значения, на основе которого будет проверяться следующий присланный пользователем во время аутентификации одноразовый пароль.


#### Достоинства
1. Защита от повторного использования
2. Вектор инициализации k не хранится на сервере и не передается по сети.

#### Недостатки
1. Ограниченное количество генерируемых паролей, заданных величиной N
2. При больших значениях N увеличивается время генерации одноразового пароля на стороне пользователя.
3. Отсутствует аутентификация сервера

___
